# Yocto Project Overview

## What is Yocto?

The **Yocto Project** is an open-source collaboration project that provides tools and templates for building custom Linux-based systems for embedded products, regardless of the hardware architecture.

> It is a collaboration of many hardware manufacturers, open-source OS vendors, and electronics companies.

---

## Why Use Yocto?

### 1. Custom Linux Distro for Any Hardware
- Build a minimal or full-featured Linux image tailored to your target hardware (ARM, x86, RISC-V, etc.).
- Choose what packages, drivers, tools, and services go into your embedded image.

### 2. Highly Scalable & Modular
- Everything is organized in layers and recipes.
- Reuse existing layers (e.g., networking, UI, Qt, machine configs) or create new ones.
- Ideal for managing multiple hardware variants or product lines.

### 3. Reproducible Builds
- Builds are deterministicâ€”same input results in the same output.
- Crucial for production and manufacturing.

### 4. Cross-Compilation Toolchain Included
- Automatically sets up cross-compilation toolchain for your target.
- Saves time manually configuring GCC, libraries, and paths.

### 5. Package and Dependency Management
- Uses `BitBake` to manage complex dependency trees.
- Supports both build-time and runtime dependencies.

### 6. License and Security Compliance
- Tracks open-source licenses.
- Supports SBOM (Software Bill of Materials) generation and CVE scanning.

### 7. Professional-Grade and Industry Standard
- Trusted by Intel, NVIDIA, Texas Instruments, NXP, etc.
- Supported by silicon vendors for working with custom SoCs.

### 8. Supports Both Minimal and Complex Systems
- Build a tiny console image with BusyBox (~10MB) or a full graphical UI with Qt.
- Suitable for IoT devices and rich UI systems.

---

## Introduction to the Yocto Project
<img width="1031" height="435" alt="image" src="https://github.com/user-attachments/assets/5f8bd57f-35a2-4d12-904f-0a7d1b98455b" />

### Source Code
Includes all components:
- Linux kernel source
- Bootloader source (e.g., U-Boot)
- Application source
- Yocto metadata (recipes, layers)

> Configuration is done through BitBake recipes and configuration files.

---

## Build System

### 1. Build Engine (BitBake)
- Executes tasks like compile, patch, assemble.
- Uses `.bb` recipes to fetch, patch, configure, and build packages.

### 2. Toolchain (Cross-Compiler)
- Compiles code on host PC targeting embedded architecture (ARM, RISC-V).
- Auto-generated by Yocto.

### 3. OpenEmbedded Core
- A set of base recipes and classes shared across layers.
- The foundation for all Yocto builds.

---

## Output Folder (Binaries)

- Contains all compiled output: programs, kernel, bootloader, libraries.
- Organized automatically during the build process.

---

## System Image(s)

Final bootable image includes:
- Bootloader (U-Boot)
- Linux Kernel
- Root Filesystem (BusyBox or full distro)
- Device Tree
- Optional apps and services

> Flash these images to your target board.

---

## Target Board (e.g., Rockchip, STM32MP1)

- The embedded board that runs the image built by Yocto.

---

## Terminal Output / Debugging

- Serial console gives logs and debug info.
- Use it to:
  - Verify boot success
  - Debug kernel messages
  - Run test applications

---

## Terminology in Yocto Project

| Term        | Description |
|-------------|-------------|
| **Poky**    | Reference distribution provided by Yocto (includes BitBake + metadata + sample config). |
| **BitBake** | The build engine used to process `.bb` files (recipes). |
| **OpenEmbedded** | The build framework used by Yocto (includes Poky + layers). |
| **Metadata** | Files that describe how to fetch, patch, build, and install software. |
| **Layer**    | Group of metadata files, categorized by purpose or vendor. |

### Metadata File Types

| File Type        | Description |
|------------------|-------------|
| `.bb` (Recipe)   | Describes how to fetch, build, install a package. |
| `.bbclass`       | Class with shared logic that recipes can inherit. |
| `.bbappend`      | Used to modify or extend an existing recipe. |
| `.inc`           | Included in recipes for reuse. |
| `.conf`          | Configuration settings (machine, local, distro). |

---

## Layers Examples

- `meta-oe` â†’ Extra open-source packages
- `meta-qt5` â†’ Qt libraries
- `meta-st-stm32mp` â†’ STMicroelectronics BSP

---

## Yocto Project Architecture

### Left: Inputs

#### 1. User Configuration
- Custom settings: which layers, packages, and image type to build.
- Set via `local.conf`, `bblayers.conf`.

#### 2. Metadata
- Recipes (`.bb`), patches, configuration options.
- May include `.bbappend` for extending functionality.

#### 3. Machine Configuration (BSP)
- Defines hardware platform (e.g., `raspberrypi4`, `stm32mp1`).
- Specifies kernel, bootloader, and device tree.

#### 4. Policy Configuration
- Defines rules: filesystem type, package format (`.deb`, `.rpm`), init system, licenses.

---

### Center: Source Mirrors

- **Upstream Repos**: kernel.org, busybox, open-source projects.
- **Local Projects**: Custom applications, internal drivers.
- **SCM Support**: Git, SVN, Mercurial.

---

### Middle: Build Process (BitBake Tasks)

1. **Source Fetching**  
   â†’ Downloads code from remote sources or mirrors.

2. **Patch Application**  
   â†’ Applies patches defined in recipes.

3. **Configure / Compile / Autoconf**  
   â†’ Configures the build environment, runs `configure` or `cmake`.

4. **Output Analysis**  
   â†’ Determines what files belong to which package.

5. **Package Generation**  
   â†’ Creates `.rpm`, `.deb`, or `.ipk` installable packages.

6. **QA Tests**  
   â†’ Ensures no missing licenses, dependencies, or architecture issues.

---

### Right: Outputs

1. **Package Feeds**
   - Repositories of installable packages (used by package managers).

2. **Images**
   - Bootable filesystem images (`.wic`, `.img`, `.ext4`).

3. **SDK Generation**
   - Generates cross-compile toolchain, headers, and libraries.
   - Used to build applications for the target.

---

## Common Build Steps in Yocto

The Yocto Project automates these steps per software package:

1. **Fetching**
   - Downloads source code (`git`, `wget`, etc.).

2. **Unpacking**
   - Extracts source archive (e.g., `.tar.gz`, `.zip`).

3. **Patching**
   - Applies board-specific or bug-fix patches.

4. **Configuration**
   - Prepares build environment using `./configure` or `cmake`.

5. **Compilation**
   - Compiles code using Yocto's cross-toolchain.

6. **Installation**
   - Installs binaries into a staging area (for target root filesystem).

7. **Packaging**
   - Creates `.ipk`, `.deb`, or `.rpm` installable packages.

8. **QA Checks**
   - Validates licenses, runtime dependencies, and architecture.

---

> ðŸ“¦ Yocto = Layers + Recipes + BitBake + Toolchain + Output Images
